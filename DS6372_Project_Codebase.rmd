---
title: "MSDS-6372-Project2"
author: "Holmes, Karki, Webb"
date: '11/12/2022'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Set-up
__Libraries__
```{r load-packages, include=FALSE}
## Source - https://statsandr.com/blog/an-efficient-way-to-install-and-load-r-packages/
# Package names
packages <- c("aplore3", "tidyverse")

# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())

if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}

# Packages loading
invisible(lapply(packages, library, character.only = TRUE))
```

```{r echo=FALSE}
packages
```
__Data Import__
```{r}
df <- glow_bonemed
summary(df) ## ratio of response (fracture) is 3:1 No to Yes
str(df)

library(naniar)
gg_miss_var(df) ## no missing data


```

__EDA__
```{r}
```


### Objective 1
Display the ability to perform EDA and build a logistic regression model for interpretation purposes.
__Simple Logistic Regression__
```{r}

```

### Objective 2
With a simple logistic regression model as a baseline, perform additional competing models to improve on prediction performance metrics.
__Complex Logistic Regression__
```{r}

```

__LDA/QDA__ ## only on numeric variables
```{r}
library(GGally)
dflda<- df[c("age","weight","height","bmi","fracscore","fracture")]
##View(dflda)
ggpairs(dflda,aes(color = fracture))



```

##splitting data
```{r}
set.seed(123)

# Split data into smaller sets: 80% training, 10% test, and 10% validate
ss <- sample(1:3,size=nrow(df),replace=TRUE,prob=c(0.8,0.1,0.1))
train <- dflda[ss==1,]  
#View(train)
test <- dflda[ss==2,]
#View(test)
valid <-dflda[ss==3,]
#View(valid)
valid$fracture
```



```{r}
library(caret)

fitControl<-trainControl(method="repeatedcv",number=5,repeats=1,classProbs=TRUE, summaryFunction=mnLogLoss)

lda.fit<-train(fracture~.,
               data=train,
               method="lda",
               trControl=fitControl,
               metric="logLoss")
lda.fit

qda.fit<-train(fracture~.,
               data=train,
               method="qda",
               trControl=fitControl,
               metric="logLoss")

qda.fit

set.seed(1234)
knn.fit<-train(fracture~.,
               data=train,
                    method="knn",
                    trControl=fitControl,
                    tuneGrid=data.frame(k=c(1,5,10,15,25,50,100,200,300,400)),
                    metric="logLoss")

knn.fit

plot(knn.fit)

```


```{r}
predictions <- data.frame(status = valid$fracture)
predictions$knn <- predict(knn.fit, valid, type = "prob")[,"No"]
predictions$LDA <- predict(lda.fit, valid, type = "prob")[,"No"]
predictions$QDA <- predict(qda.fit, valid, type = "prob")[,"No"]
View(predictions)


```


__KNN__
```{r}
```







